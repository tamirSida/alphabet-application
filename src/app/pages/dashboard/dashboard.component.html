<div class="dashboard-container">
  @if (isLoading()) {
    <div class="loading">
      <i class="fas fa-spinner fa-spin"></i>
      <p>Loading dashboard...</p>
    </div>
  } @else {
    <header class="dashboard-header">
      <div class="header-content">
        <div class="user-info">
          <h1>Welcome back</h1>
          <p>{{ user()?.email }}</p>
          <div class="operator-id">
            <i class="fas fa-id-card"></i>
            Operator ID: <strong>{{ user()?.operatorId }}</strong>
          </div>
        </div>
        <button class="sign-out-button" (click)="signOut()">
          <i class="fas fa-sign-out-alt"></i>
          Sign Out
        </button>
      </div>
    </header>

    <main class="dashboard-main">
      @if (error()) {
        <div class="error-message">
          <i class="fas fa-exclamation-triangle"></i>
          <p>{{ error() }}</p>
        </div>
      } @else {
        <!-- Application Status Card -->
        <div class="status-card">
          <div class="status-header">
            <i [class]="statusDisplay().icon"></i>
            <h2>Application Status</h2>
          </div>
          <div class="status-content">
            <div [class]="'status-badge ' + statusDisplay().class">
              {{ statusDisplay().text }}
            </div>
            
            @if (user()?.status === 'not_submitted') {
              <div class="status-description">
                <p>You haven't submitted an application yet.</p>
                @if (currentAcceptingCohort()) {
                  <p><strong>Good news!</strong> Applications are currently open for {{ currentAcceptingCohort()?.number }}.</p>
                  <p><strong>Deadline:</strong> {{ currentAcceptingCohort()?.applicationEndDate | date:'fullDate' }}</p>
                } @else {
                  <p>No applications are currently being accepted. Check back later for upcoming cohorts.</p>
                }
              </div>
            } @else if (user()?.status === 'submitted') {
              <div class="status-description">
                <p>Your application has been submitted and is currently under review.</p>
                @if (application()) {
                  <p><strong>Submitted:</strong> {{ application()?.submittedAt | date:'fullDate' }}</p>
                  <p><strong>Cohort:</strong> {{ cohort()?.number }}</p>
                }
              </div>
            } @else if (user()?.status === 'accepted') {
              <div class="status-description">
                <p>Congratulations! You have been accepted into the program.</p>
                @if (cohort()) {
                  <p><strong>Cohort:</strong> {{ cohort()?.number }}</p>
                  <p><strong>Program Start:</strong> {{ cohort()?.cohortStartDate | date:'fullDate' }}</p>
                }
              </div>
            } @else if (user()?.status === 'rejected') {
              <div class="status-description">
                <p>Unfortunately, you were not selected for this round.</p>
                @if (currentAcceptingCohort()) {
                  <p>However, applications are open for a new cohort. You're welcome to apply again!</p>
                } @else {
                  <p>Keep an eye out for future application periods.</p>
                }
              </div>
            }
          </div>
        </div>

        <!-- Action Cards -->
        <div class="action-cards">
          @if (canApply) {
            <div class="action-card apply-card">
              <i class="fas fa-edit"></i>
              <h3>Apply Now</h3>
              <p>Start your application for {{ currentAcceptingCohort()?.number }}.</p>
              <button class="primary-button" (click)="goToApplication()">
                <i class="fas fa-paper-plane"></i>
                Start Application
              </button>
            </div>
          }

          @if (hasApplication) {
            <div class="action-card view-card">
              <i class="fas fa-eye"></i>
              <h3>View Application</h3>
              <p>Review your submitted application details.</p>
              <button class="secondary-button" disabled>
                <i class="fas fa-eye"></i>
                View Application
              </button>
              <small class="coming-soon">Coming soon</small>
            </div>
          }

          @if (canReapply) {
            <div class="action-card reapply-card">
              <i class="fas fa-redo"></i>
              <h3>Apply Again</h3>
              <p>Submit a new application for {{ currentAcceptingCohort()?.number }}.</p>
              <button class="primary-button" (click)="goToApplication()">
                <i class="fas fa-paper-plane"></i>
                Apply Again
              </button>
            </div>
          }

          @if (!canApply && !canReapply && user()?.status === 'not_submitted') {
            <div class="action-card info-card">
              <i class="fas fa-info-circle"></i>
              <h3>No Open Applications</h3>
              <p>Applications are not currently being accepted. Please check back later.</p>
            </div>
          }
        </div>

        <!-- Program Information -->
        <div class="info-section">
          <h2>About the Alphabet Program</h2>
          <p>The Alphabet Program is designed to transform your future through comprehensive development and learning opportunities.</p>
          
          @if (cohort()) {
            <div class="cohort-timeline">
              <h3>{{ cohort()?.number }} Timeline</h3>
              <div class="timeline-item">
                <i class="fas fa-calendar-alt"></i>
                <span>Application Period: {{ cohort()?.applicationStartDate | date:'shortDate' }} - {{ cohort()?.applicationEndDate | date:'shortDate' }}</span>
              </div>
              <div class="timeline-item">
                <i class="fas fa-play-circle"></i>
                <span>Program Duration: {{ cohort()?.cohortStartDate | date:'shortDate' }} - {{ cohort()?.cohortEndDate | date:'shortDate' }}</span>
              </div>
            </div>
          }
        </div>
      }
    </main>
  }
</div>